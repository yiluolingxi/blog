
在 Vue3 的组合式 API 风格中，要监听数组的变化，有以下几种方案可以选择：

1.  使用 Vue 提供的 watchEffect 函数，该函数可以监听变量的变化并执行回调函数，同时可以在回调函数中访问到响应式变量的值。由于数组也是响应式的，因此可以将数组作为参数传递给 watchEffect 函数，从而监听数组的变化。如下所示：  

```js
import { watchEffect } from 'vue'

const arr = ref([1, 2, 3])

watchEffect(() => {
  console.log(arr.value) // 访问响应式数组的值
})

```

2.  使用 Vue 提供的 watch 函数，该函数可以监听指定的响应式变量并执行回调函数。由于数组也是响应式的，因此可以将数组作为参数传递给 watch 函数，从而监听数组的变化。需要注意的是，由于数组是引用类型，因此需要使用 deep 选项来深度监听数组的变化。如下所示：  

```js
import { watch } from 'vue'

const arr = ref([1, 2, 3])

watch(arr, (newVal, oldVal) => {
  console.log(newVal, oldVal) // 打印新值和旧值
}, { deep: true })

```

3.  使用 Vue 提供的 computed 函数，该函数可以根据响应式变量计算出一个新的响应式变量，同时可以在计算函数中访问到响应式变量的值。由于数组也是响应式的，因此可以将数组作为计算函数中的参数，从而监听数组的变化。如下所示：  

```js
import { computed } from 'vue'

const arr = ref([1, 2, 3])

const arrLength = computed(() => {
  console.log(arr.value.length) // 访问响应式数组的值
  return arr.value.length
})

```

需要注意的是，computed 函数只有在被访问时才会重新计算值，因此如果需要监听数组的变化，需要在计算函数中访问到响应式数组的值。

4.  使用 Vue 提供的数组变异方法，如 push、pop、shift、unshift、splice、sort 和 reverse 等方法。由于这些方法会直接修改数组，因此可以在修改数组后进行相应的操作。需要注意的是，使用这些方法修改数组时，Vue 会自动触发视图更新。如下所示：  

```js
import { ref } from 'vue'

const arr = ref([1, 2, 3])

arr.value.push(4) // 修改数组

console.log(arr.value) // [1, 2, 3, 4]

```

综上所述，以上四种方案都可以监听数组的变化，选择哪种方案取决于具体的使用场景。其中，watchEffect 和 watch 函数适用于监听数组的变化并执行相应的操作，computed 函数适用于根据数组计算出一个新的响应式变量，而数组变异方法则适用于直接修改数组并触发视图更新。


- 它们分别有哪些优缺点

每种监听数组变化的方案都有其优缺点，下面分别进行介绍：

1.  watchEffect 函数

优点：

-   可以监听任何响应式变量的变化，包括数组。
-   可以自动追踪响应式变量的依赖，当依赖变化时会自动执行回调函数。
-   可以在回调函数中访问到响应式变量的值。

缺点：

-   由于 watchEffect 函数会追踪响应式变量的所有依赖，因此在处理大型响应式变量时可能会导致性能问题。

2.  watch 函数

优点：

-   可以监听任何响应式变量的变化，包括数组。
-   可以手动指定监听的变量，可以避免监听不必要的变量。
-   可以在回调函数中访问到变量的新值和旧值。
-   可以使用 deep 选项来深度监听数组的变化。

缺点：

-   由于需要手动指定监听的变量，因此可能会漏掉一些变量的变化。

3.  computed 函数

优点：

-   可以根据响应式变量计算出一个新的响应式变量，可以避免手动监听变量的变化。
-   可以在计算函数中访问到响应式变量的值。

缺点：

-   由于 computed 函数只有在被访问时才会重新计算值，因此可能会出现计算不及时的情况。
-   如果需要监听数组的变化，需要在计算函数中访问到响应式数组的值，会增加计算的复杂性。

4.  数组变异方法

优点：

-   可以直接修改数组，非常方便。
-   修改数组后会自动触发视图更新。

缺点：

-   无法手动监听数组的变化。
-   只能监听特定的数组变异方法，无法监听数组其他的变化。

综上所述，每种方案都有其优缺点，需要根据具体的使用场景选择合适的方案。如果需要监听数组的变化并执行相应的操作，可以使用 watchEffect 函数和 watch 函数；如果需要根据数组计算出一个新的响应式变量，可以使用 computed 函数；如果需要直接修改数组并触发视图更新，可以使用数组变异方法。