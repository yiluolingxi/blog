---
title: docker - 11 | traefik 网关搭建
date: 2022-09-06
tags:
 - docker
categories: 
 - docker
---
 



## 总结
1. 


## 疑问
- [ ] 





## 提问
- [x] 
  




## 1. 前提提要、场景
在域名提供商的控制台配置域名，通过 A 记录指向搭建好 `traefik` 网关的服务器的 IP 地址。

- A 记录：记录域名对应的 IP 地址。缺点就是容易被发现服务器的真实 IP，导致 DDOS 攻击。       
- CNMAE 记录：别名记录，把域名解析到别的域名上。 CDN 加速解析是现在 CNAME 记录最大的用途。
- A 记录直接指向 IP 地址，CNAME 记录指向域名。CNAME 指向的域名也要指向 A 记录，也就说 IP 地址可以按需更换，而无需变更 CNAME 的记录值。
- 自学用途可以直接添加 A 记录，如果是长期建站、项目运营建议使用 CNAME 记录。可用于 CDN 加速，又能隐藏网站的真实 IP。





## 2. 启动服务
在传统 `nginx` 方式需要手动去配置 `proxy_pass`。然而使用 `traefik`，可以简单地在容器中配置 `labels` ，即可配置域名，启动容器域名便生效。
```yaml
labels:
  - "traefik.http.routers.whoami.rule=Host(`whoami.firefly.com`)"
```


需要给 `acme.json` 配置 600 权限，否则会报错。
```json
{"level":"error","msg":"The ACME resolver \"le\" is skipped from the resolvers list because: unable to get ACME account: permissions 777 for acme.json are too open, please use 600","time":"2022-09-06T15:41:17Z"}
```





## 遗留
- [ ] A 记录还需要看回放进行整理。




个人github：[**https://github.com/zhengjiabo**](https://github.com/zhengjiabo) 